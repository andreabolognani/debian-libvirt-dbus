From: Pavel Hrdina <phrdina@redhat.com>
Date: Mon, 15 Apr 2019 17:22:07 +0200
Subject: tests: fix test_connect_node_device_create_xml test case
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: 8bit

Calling fixtures directly was removed in pytest 4.0, we can change the
fixture to be a wrapper around the original function and use the
original fixture name.

Signed-off-by: Pavel Hrdina <phrdina@redhat.com>
Reviewed-by: JÃ¡n Tomko <jtomko@redhat.com>
(cherry picked from commit 9950c0c46d7eb3f3e7052b34464e8499b67d358a)

Bug-Debian: https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=952200
---
 tests/libvirttest.py | 15 +++++++++------
 1 file changed, 9 insertions(+), 6 deletions(-)

diff --git a/tests/libvirttest.py b/tests/libvirttest.py
index 14baf5b..a442196 100644
--- a/tests/libvirttest.py
+++ b/tests/libvirttest.py
@@ -84,13 +84,7 @@ class BaseTestClass():
         interface_obj.Create(0)
         return path, interface_obj
 
-    @pytest.fixture
     def node_device_create(self):
-        """ Fixture to create dummy node device on the test driver
-
-        This fixture should be used in the setup of every test manipulating
-        with node devices.
-        """
         # We need a usable parent nodedev: possible candidates are
         # scsi_host2 (available since libvirt 3.1.0) and
         # test-scsi-host-vport (available until libvirt 3.0.0).
@@ -109,6 +103,15 @@ class BaseTestClass():
         path = self.connect.NodeDeviceCreateXML(xml, 0)
         return path
 
+    @pytest.fixture(name="node_device_create")
+    def fixture_node_device_create(self):
+        """ Fixture to create dummy node device on the test driver
+
+        This fixture should be used in the setup of every test manipulating
+        with node devices.
+        """
+        return self.node_device_create()
+
     @pytest.fixture
     def storage_volume_create(self):
         """ Fixture to create dummy storage volume on the test driver
